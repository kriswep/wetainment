{"componentChunkName":"component---src-templates-blog-post-js","path":"/tree-shaking/","result":{"data":{"markdownRemark":{"html":"<h4>with webpack v2.2, Babel and ES2015 modules</h4>\n<p><strong>Tl,dr: To setup tree shaking you can use the recently releases <a href=\"https://webpack.js.org/\">webpack version 2+</a> and use ES2015 modules. If you’re using <a href=\"https://babeljs.io/\">babel</a> to transpile, disable its ES2015 module transformation to commonjs.</strong></p>\n<p>This weekend I set down and updated my small <a href=\"https://github.com/kriswep/modern-modular-javascript\">modern Javascript boilerplate</a> code to using webpack2. One of te reasons to do so, was being able to use tree shaking. In case you’re not familiar, tree shaking as it’s core eliminates unused code from the final build output.</p>\n<p>An seemingly easy way to set that up is to use wepack v2+ and ES2015 modules.\nThese modules are static and the prerequisite for tree shaking with webpack.\nThat’s the problem when using babel and babel-loader in your webpack config. Chances are, you’re using a preset which includes the <code class=\"language-text\">transform-es2015-modules-commonjs</code> presets. Nowadays, this can be prevented by setting the <code class=\"language-text\">modules: false</code> option in <code class=\"language-text\">.babelrc</code> <del>and in the webpack.config.js babel-loader configuration. Yes, in both places!</del> <strong>UPDATE:</strong> Turned out, I was wrong here. If you don’t specify the optin in your webpack conf, it is sufficent to specify it in .babelrc. But I couldn’t make it work the other way round…</p>\n<p><strong><code class=\"language-text\">.babelrc</code></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"presets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"modules\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><code class=\"language-text\">webpack.config.js</code> (excerpt)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\nmodule<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  rules<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      test<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.jsx?$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      exclude<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(node_modules|bower_components)</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      loader<span class=\"token operator\">:</span> <span class=\"token string\">'babel-loader'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//UPDATE: This is not needed</span>\n      <span class=\"token comment\">//options: {</span>\n      <span class=\"token comment\">//  presets: [</span>\n      <span class=\"token comment\">//    ['env', { modules: false }],</span>\n      <span class=\"token comment\">//  ],</span>\n      <span class=\"token comment\">//},</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>Also make sure to use the <code class=\"language-text\">-p</code> flag in your webpack build call, which enbales minification: <code class=\"language-text\">&quot;build&quot;: &quot;webpack -p&quot;</code></p>\n<p>As a reference, feel free to check out my <a href=\"https://raw.githubusercontent.com/kriswep/modern-modular-javascript/70d17eee2c6456f8639ea1db3de4bd596f5af374/package.json\">package.json</a> (which includes my babel configuration) and <a href=\"https://raw.githubusercontent.com/kriswep/modern-modular-javascript/70d17eee2c6456f8639ea1db3de4bd596f5af374/webpack.config.babel.js\">webpack.config.js</a>.</p>\n<p>If this helped you out, or you’re facing problems getting tree shaking to work,\nfeel free to let me know on my <a href=\"https://twitter.com/kriswep\">twitter @kriswep</a>.\nYou may also be interested in reading the webpack documentation about <a href=\"https://webpack.js.org/guides/tree-shaking/\">tree shaking</a>, or this helpful <a href=\"http://www.2ality.com/2015/12/webpack-tree-shaking.html\">article</a> by Axel Rauschmayer.</p>","fields":{"slug":"/articles/2017-03-Tree-shaking/"},"frontmatter":{"date":"March 12, 2017","path":"/tree-shaking/","title":"Quick tip: Tree Shaking","description":"Setting up tree shaking with webpack2, Babel and ES2015 modules","author":"@kriswep","layout":"post","readNext":"/articles/2017-12-Comment-System/","issueNumber":10}},"readNext":{"frontmatter":{"date":"December 17, 2017","path":"/comment-system/","title":"GitComment","description":"Recently, I added a new comment system on this blog, leveraging GitHub issues as a 'backend' for the comments. Would love you writing something there."}},"site":{"siteMetadata":{"title":"wetainment","siteUrl":"https://wetainment.com"}}},"pageContext":{"slug":"/articles/2017-03-Tree-shaking/","readNext":"/articles/2017-12-Comment-System/"}},"staticQueryHashes":[]}